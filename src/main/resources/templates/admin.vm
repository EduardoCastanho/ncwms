<html>
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.2/css/bulma.css"
        integrity="sha256-tzp6mtxeugpv7nF5uY4rqr1ZxZynL8F7G5MCwYxJkmY=" crossorigin="anonymous"/>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Administrative interface to ncWMS</title>
  <style>
    label{ white-space: nowrap;}
  </style>

</head>
<body>

<form class="form" id="config" action="updateConfig" method="POST">
  <nav class="nav has-shadow">
    <div class="container">
      <div class="nav-left">
        <div class="nav-item"><strong style="font-size: 1.2rem">ncWMS(v$version) Admin</strong></div>
      </div>
      <div class="nav-center">
        <p class="nav-item"><a href="../Godiva3.html">Godiva3 interface</a></p>
          #if($config.serverInfo.allowsGlobalCapabilities())
            <p class="nav-item ">
              <a href="../wms?SERVICE=WMS&amp;REQUEST=GetCapabilities&amp;VERSION=1.3.0">
                WMS 1.3.0 Capabilities</a>
            </p>
            <p class="nav-item">
              <a href="../wms?SERVICE=WMS&amp;REQUEST=GetCapabilities&amp;VERSION=1.1.1">
                WMS 1.1.1 Capabilities</a>
            </p>
          #end
        <p class="nav-item"><a href="../">ncWMS Front page</a></p>
      </div>
      <div class="nav-right">
        <div class="nav-item">
          <input id="asd" class="button is-success"
                 type="submit" value="Save configuration" name="submit1"/>
        </div>
      </div>
    </div>
  </nav>
  <section class="container ">
      #if(!$config.serverInfo.allowsGlobalCapabilities())
        <div id="warn_gl_cap" class="has-text-centered notification is-warning">
          <button type="button" id="warn_gl_cap_btn" class="delete"></button>
          Global GetCapabilities Disabled(Server Settings).
        </div>
      #end
    <div class="tabs is-boxed is-left is-large is-marginless ">
      <ul>
        <li><a href='#tab1'>Datasets</a></li>
        <li><a href='#tab2'>Dynamic Services</a></li>
        <li><a href='#tab3'>Cache settings</a></li>
        <li><a href='#tab4'>Server settings</a></li>
        <li><a href='#tab5'>Contact information</a></li>
      </ul>
    </div>
    <div class="box is-marginless">
      <div id='tab1'>
        <nav class="level" style="margin-bottom: 0.5rem">
          <div class="level-left">
            <p class="level-item">Number of services: $!config.datasets.size()</p>
          </div>
          <div class="level-right">
            <div class="level-item">
              <button id="add_button" class="button is-primary" type=button>Add Dataset</button>
            </div>
          </div>
        </nav>
        <table class="table is-bordered is-striped is-narrow">
          <tbody id="dataset_body">
              #foreach($dataset in $config.datasets)
              <tr id="row$!dataset.id">
                <td>
                  <br/>
                  <div class="columns" style="margin-bottom: 0">
                    <div class="column ">
                      <br/>
                      <div class="field is-horizontal" style="margin-bottom: 0px;">
                        <div class="field-label is-small"><label class="label">Dataset ID</label></div>
                        <div class="field-body field is-grouped">
                          <p class="control is-expanded">
                            <input class="input is-small " type="text" name="dataset.$!{dataset.id}.id"
                                   value="$!{dataset.id}"
                                   title="An alphanumeric identifier for the dataset.  Must be unique"/>
                          </p>
                        </div>
                        <div class="field-label is-small">
                          <label class="label is-small">Title</label>
                        </div>
                        <div class="field-body field is-grouped">
                          <p class="control is-expanded">
                            <input class="input is-small" type="text" name="dataset.$!{dataset.id}.title"
                                   value="$!{dataset.title}"
                                   title="The title of the dataset to be displayed in menus/GetCapabilities"/>
                          </p>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-small">
                          <label class="label">Dataset Location</label>
                        </div>
                        <div class="field-body field is-grouped">
                          <p class="control is-expanded">
                            <input class="input is-small" type="text" name="dataset.$!{dataset.id}.location"
                                   value="$!{dataset.location}"
                                   title="The location on disk (or via OPeNDAP) of the dataset"/>
                          </p>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-small">
                          <label class="label">Dataset Metadata URL</label>
                        </div>
                        <div class="field-body field is-grouped">
                          <p class="control is-expanded">
                            <input class="input is-small" type="text" name="dataset.$!{dataset.id}.datasetMetadataURL"
                                   value="$!{dataset.datasetMetadataURL}"
                                   title="The location on disk (or via OPeNDAP) of the dataset"/>
                          </p>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-small">
                          <label class="label">Service Metadata URL</label>
                        </div>
                        <div class="field-body field is-grouped">
                          <p class="control is-expanded">
                            <input class="input is-small" type="text" name="dataset.$!{dataset.id}.serviceMetadataURL"
                                   value="$!{dataset.serviceMetadataURL}"
                                   title="The location on disk (or via OPeNDAP) of the dataset"/>
                        </div>
                      </div>
                    </div>
                    <div class="column is-narrow"
                         style=" display: flex;  flex-direction: column;  justify-content: center;">
                      <div class="field">
                        <p class="control is-pulled-right">
                          <label class="checkbox">
                            Disabled:
                            <input type="checkbox" name="dataset.$!{dataset.id}.disabled"#if($!{dataset.disabled})
                                   checked="checked"#end
                                   title="If this is checked, the dataset will not be available through any services, but will remain configured for future use"/>
                          </label>
                        </p>
                      </div>
                      <br/>
                      <div class="field">
                        <p class="control is-pulled-right">
                          <label class="checkbox">
                            Queryable:
                            <input type="checkbox" name="dataset.$!{dataset.id}.queryable"#if($!{dataset.queryable})
                                   checked="checked"#end
                                   title="If this is checked, values from the dataset can be queried through the GetFeatureInfo request"/>
                          </label>
                        </p>
                      </div>
                      <br/>
                      <div class="field">
                        <p class="control is-pulled-right">
                          <label class="checkbox">
                            Downloadable:
                            <input type="checkbox"
                                   name="dataset.$!{dataset.id}.downloadable"#if($!{dataset.downloadable})
                                   checked="checked"#end
                                   title="If this is checked, access to the raw data will be available.  This is accessed through GetMap requests with the format application/prs.coverage+json, or through GetTimeseries/GetVerticalProfile requests with the format text/csv"/>
                          </label>
                        </p>
                      </div>
                      <br/>
                      <div class="field">
                        <label class="label">
                          Auto-refresh rate:</label>
                        <p class="control  is-expanded">
                          <span class="select is-fullwidth ">
                             <select name="dataset.$!{dataset.id}.updateinterval"
                                     title="How often this dataset should be re-read from source">
                            <option value="-1"#if($dataset.updateInterval < 0) selected="selected"#end>Never</option>
                            <option value="1"#if($dataset.updateInterval == 1) selected="selected"#end>1 min</option>
                            <option value="10"#if($dataset.updateInterval == 10) selected="selected"#end>10 min</option>
                            <option value="30"#if($dataset.updateInterval == 30) selected="selected"#end>30 min</option>
                            <option value="60"#if($dataset.updateInterval == 60) selected="selected"#end>1 hr</option>
                            <option value="360"#if($dataset.updateInterval == 360) selected="selected"#end>6 hr</option>
                            <option value="720"#if($dataset.updateInterval == 720)
                                    selected="selected"#end>12 hr</option>
                            <option value="1440"#if($dataset.updateInterval == 1440)
                                    selected="selected"#end>24 hr</option>
</select>
                          </span>
                        </p>
                      </div>
                    </div>
                    <div class="column is-narrow"
                         style=" display: flex;  flex-direction: column;  justify-content: center;">
                      <div class="panel">
                        <div class="panel-block">
                          <a class="button is-info is-outlined is-fullwidth"
                             href="editVariables?dataset=$!dataset.id"
                             type=button #if(!$dataset.ready)disabled#end>
                            Edit Variables</a>
                        </div>
                        <div class="panel-block">
                          <a class="button is-warning is-outlined is-fullwidth" href="forceRefresh?dataset=$!dataset.id"
                             type=button #if($dataset.disabled)disabled#end>Force refresh</a>
                        </div>
                        <div class="panel-block">
                          <button id="$!dataset.id" class="button is-danger is-outlined is-fullwidth delete_row" type=button>Delete</button>
                          <!-- href="deleteDataset?dataset=$!dataset.id" -->

                        </div>
                      </div>
                    </div>
                  </div>
                  <nav class="level ">
                    <div class="level-right">
                        #if($dataset.disabled)
                          <p class="level-item tag is-warning">Disabled</p>
                        #elseif($dataset.loading)
                          <a class="level-item tag is-info" target="_blank"
                             href="datasetStatus?dataset=$!{dataset.id}">
                              $!{dataset.state}</a>
                        #elseif($dataset.hasError())
                          <div class="notification  is-small is-danger  is-paddingless is-marginless">
                              $!{dataset.state}:<br/>
                            <em>$!{dataset.getException().getMessage()}<br/>
                                $!{dataset.getException().getCause().getMessage()}
                              <a target="_blank" href="datasetStatus?dataset=$!{dataset.id}">More...</a></em>
                          </div>
                        #else
                          <p class="level-item tag is-success">$!{dataset.state}</p>
                        #end
                        #if($dataset.lastUpdateTime)
                          <p class="level-item tag is-info">
                            Last update Datetime:$TimeUtils.formatUtcHumanReadableDateTime($dataset.lastUpdateTime)
                          </p>
                        #end

                    </div>
                  </nav>
                </td>
              </tr>
              #* This is hidden because is not needed for the current use,
              * but is needed in server side logic.
              * It was not removed because may become usefull later.*#
              <input type="text" name="dataset.$!{dataset.id}.reader" value="$!{dataset.dataReaderClass}" size="10"
                     title="The class to use for reading data. If blank, this will use
                     the default data reader which works for all NetCDF CF-compliant gridded datasets" hidden/>
              #end
          </tbody>
        </table>
        <script id="cenas" type="text/x-tmpl">
          <tr id="new_row#NUMBER#">
            <td>
            <br/>
              <div class="columns" style="margin-bottom: 0">
                <div class="column ">
                  <div class="field is-horizontal" style="margin-bottom: 0px;">
                    <div class="field-label is-small"><label class="label">Dataset ID</label></div>
                    <div class="field-body field is-grouped">
                      <p class="control is-expanded">
                        <input class="input is-small " type="text" name="dataset.new#NUMBER#.id"
                               value=""
                               title="An alphanumeric identifier for the dataset.  Must be unique"/>
                      </p>
                    </div>
                    <div class="field-label is-small">
                      <label class="label is-small">Title</label>
                    </div>
                    <div class="field-body field is-grouped">
                      <p class="control is-expanded">
                        <input class="input is-small" type="text" name="dataset.new#NUMBER#.title"
                               value=""
                               title="The title of the dataset to be displayed in menus/GetCapabilities"/>
                      </p>
                    </div>
                  </div>
                  <div class="field is-horizontal">
                    <div class="field-label is-small">
                      <label class="label">Dataset Location</label>
                    </div>
                    <div class="field-body field is-grouped">
                      <p class="control is-expanded">
                        <input class="input is-small" type="text" name="dataset.new#NUMBER#.location"
                               value=""
                               title="The location on disk (or via OPeNDAP) of the dataset"/>
                      </p>
                    </div>
                  </div>
                  <div class="field is-horizontal">
                    <div class="field-label is-small">
                      <label class="label">Dataset Metadata URL</label>
                    </div>
                    <div class="field-body field is-grouped">
                      <p class="control is-expanded">
                        <input class="input is-small" type="text" name="dataset.new#NUMBER#.datasetMetadataURL"
                               value=""
                               title="The location on disk (or via OPeNDAP) of the dataset"/>
                      </p>
                    </div>
                  </div>
                  <div class="field is-horizontal">
                    <div class="field-label is-small">
                      <label class="label">Service Metadata URL</label>
                    </div>
                    <div class="field-body field is-grouped">
                      <p class="control is-expanded">
                        <input class="input is-small" type="text" name="dataset.new#NUMBER#.serviceMetadataURL"
                               value=""
                               title="The location on disk (or via OPeNDAP) of the dataset"/>
                    </div>
                  </div>

                </div>
                <div class="column is-narrow" style=" display: flex;  flex-direction: column;  justify-content: center;">
                  <div class="field">
                    <p class="control is-pulled-right">
                      <label class="checkbox">
                        Disabled:
                        <input type="checkbox" name="dataset.new#NUMBER#.disabled"
                               title="If this is checked, the dataset will not be available through any services, but will remain configured for future use"/>
                      </label>
                    </p>
                  </div>
                  <br/>
                  <div class="field">
                    <p class="control is-pulled-right">
                      <label class="checkbox">
                        Queryable:
                        <input type="checkbox" name="dataset.new#NUMBER#.queryable" checked="checked"
                               title="If this is checked, values from the dataset can be queried through the GetFeatureInfo request"/>
                      </label>
                    </p>
                  </div>
                  <br/>
                  <div class="field">
                    <p class="control is-pulled-right">
                      <label class="checkbox">
                        Downloadable:
                        <input type="checkbox" name="dataset.new#NUMBER#.downloadable"
                               title="If this is checked, access to the raw data will be available.  This is accessed through GetMap requests with the format application/prs.coverage+json, or through GetTimeseries/GetVerticalProfile requests with the format text/csv"/>
                      </label>
                    </p>
                  </div>
                  <br/>
                  <div class="field">
                    <label class="label">
                      Auto-refresh rate:</label>
                    <p class="control  is-expanded">
                          <span class="select is-fullwidth ">
                            <select name="dataset.new#NUMBER#.updateinterval">
                              <option value="-1">Never</option>
                              <option value="1">1 min</option>
                              <option value="10">10 min</option>
                              <option value="30">30 min</option>
                              <option value="60">1 hr</option>
                              <option value="360">6 hr</option>
                              <option value="720">12 hr</option>
                              <option value="1440">24 hr</option>
                            </select>
                          </span>
                    </p>
                  </div>
                </div>
                <div class="column is-narrow" style=" display: flex;  flex-direction: column;  justify-content: center;">
                  <div class="panel">
                    <div class="panel-block">
                          <a class="button is-info is-outlined is-fullwidth" type=button disabled>Edit Variables</a>
                    </div>
                    <div class="panel-block">
                      <a class="button is-warning is-outlined is-fullwidth " type=button disabled>Force refresh</a>
                    </div>
                    <div class="panel-block">
                      <a  id="#NUMBER#" class="button is-danger is-outlined is-fullwidth delete_new_row" type=button>Delete</a>
                         #*TODO falta remover da lista se novo*#
                    </div>
                  </div>
                </div>
              </div>
              <nav class="level ">
                <div class="level-right">
                      <p class="level-item tag is-success">NEW</p>
                </div>
              </nav>
            </td>
            <input type="text" name="dataset.new#NUMBER#.reader" value="" size="10"
                     title="The class to use for reading data. If blank, this will use
                     the default data reader which works for all NetCDF CF-compliant gridded datasets" hidden/>
          </tr>
          #* This is hidden because is not needed for the current use,
              * but is needed in server side logic.
              * It was not removed because may become usefull later.*#


        </script>
      </div>
      <div id='tab2'>
        <nav class="level" style="margin-bottom: 0.5rem">
          <div class="level-left">
            <p class="level-item">Number of Dynamic Services: $!config.dynamicServices.size()</p>
          </div>
          <div class="level-right">
            <div class="level-item">
              <button id="add_dynamic_button" class="button is-primary" type=button>Add Dynamic Service</button>
            </div>
          </div>
        </nav>
        <table class="table is-bordered is-striped is-narrow">
          <tbody id="dynamic_body">
              #foreach($dynamicService in $config.dynamicServices)
              <tr id="row_dynamic$!{dynamicService.alias}">
                <td>
                  <div class="columns" style="margin-bottom: 0">
                    <div class="column  ">
                      <br/>
                      <div class="field is-horizontal" style="margin-bottom: 0px;">
                        <div class="field-label is-small"><label class="label">Alias</label></div>
                        <div class="field-body field is-grouped">
                          <p class="control is-expanded">
                            <input class="input is-small " type="text"
                                   name="dynamicService.$!{dynamicService.alias}.alias"
                                   value="$!{dynamicService.alias}"
                                   title=""/>
                          </p>
                        </div>
                        <div class="field-label is-small">
                          <label class="label is-small">Match regex</label>
                        </div>
                        <div class="field-body field is-grouped">
                          <p class="control is-expanded">
                            <input class="input is-small" type="text"
                                   name="dynamicService.$!{dynamicService.alias}.datasetIdMatch"
                                   value="$!{dynamicService.datasetIdMatch}"
                                   title=""/>
                          </p>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-small">
                          <label class="label">Datasets Folder Location</label>
                        </div>
                        <div class="field-body field is-grouped">
                          <p class="control is-expanded">
                            <input class="input is-small" type="text"
                                   name="dynamicService.$!{dynamicService.alias}.servicePath"
                                   value="$!{dynamicService.servicePath}"
                                   title=""/>
                          </p>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-small">
                          <label class="label">Dataset Metadata URL</label>
                        </div>
                        <div class="field-body field is-grouped">
                          <p class="control is-expanded">
                            <input class="input is-small" type="text" name="dataset.$!{dataset.id}.datasetMetadataURL"
                                   value="$!{dataset.datasetMetadataURL}"
                                   title="The location on disk (or via OPeNDAP) of the dataset"/>
                          </p>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-small">
                          <label class="label">Service Metadata URL</label>
                        </div>
                        <div class="field-body field is-grouped">
                          <p class="control is-expanded">
                            <input class="input is-small" type="text" name="dataset.$!{dataset.id}.serviceMetadataURL"
                                   value="$!{dataset.serviceMetadataURL}"
                                   title="The location on disk (or via OPeNDAP) of the dataset"/>
                        </div>
                      </div>
                    </div>
                    <div class="column is-narrow"
                         style=" display: flex;  flex-direction: column;  justify-content: center;">
                      <div class="field">
                        <p class="control is-pulled-right">
                          <label class="checkbox">
                            Disabled:
                            <input type="checkbox"
                                   name="dynamicService.$!{dynamicService.alias}.disabled"#if($!{dynamicService.disabled})
                                   checked="checked"#end
                                   title="If this is checked, the dataset will not be available through any services, but will remain configured for future use"/>
                          </label>
                        </p>
                      </div>
                      <br/>
                      <div class="field">
                        <p class="control is-pulled-right">
                          <label class="checkbox">
                            Queryable:
                            <input type="checkbox"
                                   name="dynamicService.$!{dynamicService.alias}.queryable"#if($!{dynamicService.queryable})
                                   checked="checked"#end
                                   title="If this is checked, values from the dataset can be queried through the GetFeatureInfo request"/>
                          </label>
                        </p>
                      </div>
                      <br/>
                      <div class="field">
                        <p class="control is-pulled-right">
                          <label class="checkbox">
                            Downloadable:
                            <input type="checkbox"
                                   name="dynamicService.$!{dynamicService.alias}.downloadable"#if($!{dynamicService.downloadable})
                                   checked="checked"#end
                                   title="If this is checked, access to the raw data will be available.  This is accessed through GetMap requests with the format application/prs.coverage+json, or through GetTimeseries/GetVerticalProfile requests with the format text/csv"/>
                          </label>
                        </p>
                      </div>

                    </div>
                    <div class="column is-narrow"
                         style=" display: flex;  flex-direction: column;  justify-content: center;">
                      <button id="$!{dynamicService.alias}" class="button is-danger is-outlined is-fullwidth delete_dynamic_row" type=button>Delete</button>
                    </div>
                </td>
              </tr>
              #* This is hidden because is not needed for the current use,
              * but is needed in server side logic.
              * It was not removed because may become usefull later.*#
              <input type="text" name="dynamicService.$!{dynamicService.alias}.reader"
                     value="$!{dynamicService.dataReaderClass}" size="10"
                     title="The class to use for reading data. If blank, this will use
                     the default data reader which works for all NetCDF CF-compliant gridded datasets" hidden/>

              #end
          </tbody>
        </table>
        <script id="dynamicTemplate" type="text/x-tmpl">
          <tr id="new_dynamic_row#NUMBER#">
            <td>
              <div class="columns" style="margin-bottom: 0">
                <div class="column ">
                <br/>
                  <div class="field is-horizontal" style="margin-bottom: 0px;">
                    <div class="field-label is-small"><label class="label">Alias</label></div>
                    <div class="field-body field is-grouped">
                      <p class="control is-expanded">
                        <input class="input is-small " type="text" name="dynamicService.new#NUMBER#.alias"
                               value=""
                               title=""/>
                      </p>
                    </div>
                    <div class="field-label is-small">
                      <label class="label is-small">Match regex</label>
                    </div>
                    <div class="field-body field is-grouped">
                      <p class="control is-expanded">
                        <input class="input is-small" type="text" name="dynamicService.new#NUMBER#.datasetIdMatch"
                               value=".*"
                               title=""/>
                      </p>
                    </div>
                  </div>
                  <div class="field is-horizontal">
                    <div class="field-label is-small">
                      <label class="label">Datasets Folder Location</label>
                    </div>
                    <div class="field-body field is-grouped">
                      <p class="control is-expanded">
                        <input class="input is-small" type="text" name="dynamicService.new#NUMBER#.servicePath"
                               value=""
                               title="The location on disk (or via OPeNDAP) of the dataset"/>
                      </p>
                    </div>
                  </div>
                  <div class="field is-horizontal">
                    <div class="field-label is-small">
                      <label class="label">Dataset Metadata URL</label>
                    </div>
                    <div class="field-body field is-grouped">
                      <p class="control is-expanded">
                        <input class="input is-small" type="text" name="dynamicService.new#NUMBER#.datasetMetadataURL"
                               value=""
                               title="The location on disk (or via OPeNDAP) of the dataset"/>
                      </p>
                    </div>
                  </div>
                  <div class="field is-horizontal">
                    <div class="field-label is-small">
                      <label class="label">Service Metadata URL</label>
                    </div>
                    <div class="field-body field is-grouped">
                      <p class="control is-expanded">
                        <input class="input is-small" type="text" name="dynamicService.new#NUMBER#.serviceMetadataURL"
                               value=""
                               title="The location on disk (or via OPeNDAP) of the dataset"/>
                    </div>
                  </div>

                </div>
                <div class="column is-narrow" style=" display: flex;  flex-direction: column;  justify-content: center;">
                  <div class="field">
                    <p class="control is-pulled-right">
                      <label class="checkbox">
                        Disabled:
                        <input type="checkbox" name="dynamicService.new#NUMBER#.disabled"
                               title="If this is checked, the dataset will not be available through any services, but will remain configured for future use"/>
                      </label>
                    </p>
                  </div>
                  <br/>
                  <div class="field">
                    <p class="control is-pulled-right">
                      <label class="checkbox">
                        Queryable:
                        <input type="checkbox" name="dynamicService.new#NUMBER#.queryable" checked="checked"
                               title="If this is checked, values from the dataset can be queried through the GetFeatureInfo request"/>
                      </label>
                    </p>
                  </div>
                  <br/>
                  <div class="field">
                    <p class="control is-pulled-right">
                      <label class="checkbox">
                        Downloadable:
                        <input type="checkbox" name="dynamicService.new#NUMBER#.downloadable"
                               title="If this is checked, access to the raw data will be available.  This is accessed through GetMap requests with the format application/prs.coverage+json, or through GetTimeseries/GetVerticalProfile requests with the format text/csv"/>
                      </label>
                    </p>
                  </div>
                </div>
                <div class="column is-narrow" style=" display: flex;  flex-direction: column;  justify-content: center;">
                      <a  id="#NUMBER#" class="button is-danger is-outlined is-fullwidth delete_new_row" type=button>Delete</a>
                  </div>
                </div>
              </div>
              <nav class="level ">
                <div class="level-right">
                      <p class="level-item tag is-success">NEW</p>
                </div>
              </nav>
            </td>
            <input type="text" name="dynamicService.new#NUMBER#.reader" value="" size="10"
                     title="The class to use for reading data. If blank, this will use
                     the default data reader which works for all NetCDF CF-compliant gridded datasets" hidden/>
          </tr>
          #* This is hidden because is not needed for the current use,
              * but is needed in server side logic.
              * It was not removed because may become usefull later.*#

































        </script>
        <div class="content">
          <p>Dynamic services are either local or DAP services which can be generated when requested, rather than being
             preconfigured. This is aimed at cases where a server wishes to access data stores which may consist of a
             very large number of datasets.
          </p>
          <p>
            These datasets can be accessed via all of the usual ncWMS methods by adding the URL parameter
            <code> DATASET={DatasetAlias}{/path/under/service/path}</code>.
          </p>

          <p>For example if you configure a dataset below with the ID "local" and the service URL
             "/media/data/model_output/"
             adding the parameter:</p>

          <p><code>DATASET=local/mymodel/may_2014.nc</code></p>

          <p>will generate a dataset from the NetCDF file at the path /media/data/model_output/mymodel/may_2014.nc</p>

          <p>Any path will be tested against the <a href="http://en.wikipedia.org/wiki/Regular_expression">regular
                                                                                                           expression</a>
             supplied in
             the "Match regex" and only paths matching that regular expression will be allowed.
             For example, if the regex is set to ".*may.*" then the above example would work as before, but:</p>

          <ul>
            <li><code>DATASET=local/mymodel/april_2014.nc</code></li>
            <li><code>DATASET=local/mymodel/01-05-2014.nc</code></li>
            <li><code>DATASET=local/mymodel/june_2014.nc</code></li>
          </ul>

          <p>would all be treated as though there were no dataset, regardless of whether the files actually exist.</p>
        </div>
      </div>
      <div id='tab3'>
        <div class="content">
          <div id="warn_cache" class=" notification is-warning">
            <button type="button" id="warn_cache_btn" class="delete"></button>
            Changing these definitions require that the cache has to be emptied!
          </div>
          <h5 class="title is-5">This ncWMS server uses a cache of recently-extracted features to increase
                                 performance and reduce the load on the server.
            <br/>Note that the cache will use up
                                 some memory (configurable below).</h5>

          <table class="table is-narrow">
            <tbody>
            <tr>
              <th>Enable cache?</th>
              <td><input class="checkbox" type="checkbox" name="cache.enable"#if($!{config.cacheSettings.enabled})
                         checked="checked"#end/>
              </td>
              <td>Check this box to enable the cache.</td>
            </tr>
            <tr>
              <th>Total size of cache in memory (MB)</th>
              <td><input class="input" type="text" name="cache.inMemorySizeMB"
                         value="$!{config.cacheSettings.inMemorySizeMB}"/>
              </td>
              <td>The maximum in-memory size of the cache. Once the cache exceeds this size, elements will be removed
                  from it, based on how frequently they have been used, followed by how recently they have been used.
              </td>
            </tr>
            <tr>
              <th>Lifetime of in-memory elements (minutes)</th>
              <td class="narow"><input class="input" type="text" name="cache.elementLifetimeMinutes"
                                       value="$!{config.cacheSettings.elementLifetimeMinutes}"/></td>
              <td>The time each element will remain in the cache for. Setting this to zero means that each element will
                  remain indefinitely, only being removed once the memory limit (above) is reached, and cache cleanup
                  occurs.
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div id='tab4'>
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Title</label></div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="input" type="text" name="server.title"
                                          value="$!{config.serverInfo.name}"
                                          placeholder="Title for this WMS Server"/>
                <p class="help ">Title for this WMS Server</p></div>
            </div>
          </div>
        </div>
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Abstract</label></div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <textarea class="textarea"
                          type="text"
                          name="server.abstract"
                          placeholder="More details about this server">$!{config.serverInfo.abstract}</textarea>
                <p class="help">More details about this server</p></div>
            </div>
          </div>
        </div>
          #set($keywords = "")
          #foreach($keyword in $config.serverInfo.keywords)
              #set($keywords = $keywords + $keyword)
              #if($foreach.hasNext)
                  #set($keywords = $keywords + ", ")
              #end
          #end
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Keywords</label></div>
          <div class="field-body">
            <div class="field">
              <div class="control">
                <input class="input" type="text" name="server.keywords"
                       value="$!{keywords}"
                       placeholder="Comma-separated list of keywords"/>
                <p class="help ">Comma-separated list of keywords</p></div>
            </div>
          </div>
        </div>
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">URL</label></div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="input" type="text" name="server.url"
                                          value="$!{config.serverInfo.url}"
                                          placeholder="Web site of the service provider"/>
                <p class="help ">Web site of the service provider</p></div>
            </div>
          </div>
        </div>
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Inspire Server URL Metadata</label></div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="input" type="text" name="server.inspireServiceMetadataURL"
                                          value="$!{config.serverInfo.inspireServiceMetadataURL}"
                                          placeholder="              INSPIRE complient metadata #*TODO finish this... *#
            "/>
                <p class="help ">INSPIRE complient metadata</p></div>
            </div>
          </div>
        </div>
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Max image width</label></div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="input" type="text" name="server.maximagewidth"
                                          value="$!{config.serverInfo.maxImageWidth}"
                                          placeholder="Maximum width of image that can be requested"/>
                <p class="help">Maximum width of image that can be requested</p></div>
            </div>
          </div>
        </div>
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Max image height</label></div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="input" type="text" name="server.maximageheight"
                                          value="$!{config.serverInfo.maxImageHeight}"
                                          placeholder="Maximum width of image that can be requested"/>
                <p class="help ">Maximum width of image that can be requested</p></div>
            </div>
          </div>
        </div>
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Allow GetFeatureInfo</label></div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="checkbox" type="checkbox"
                                          name="server.allowfeatureinfo"#if($!{config.serverInfo.allowsFeatureInfo()})
                                          checked="checked"#end
                                          title="Check this box to enable the GetFeatureInfo operation"/>
                <p class="help ">Check this box to enable the GetFeatureInfo operation
                </p></div>

            </div>

          </div>
        </div>
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Allow global Capabilities</label></div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="checkbox" type="checkbox"
                                          name="server.allowglobalcapabilities"#if($!{config.serverInfo.allowsGlobalCapabilities()})
                                          checked="checked"#end
                                          title="Check this box to allow clients to request a WMS Capabilities document including all datasets"/>
                <p class="help">Check this box to allow clients to request a WMS Capabilities document
                                including all datasets on this
                                server (not recommended if this server hosts a large number of datasets)
                </p></div>
            </div>
          </div>
        </div>
      </div>
      <div id='tab5'>
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Name</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="input" type="text" name="contact.name"
                                        value="$!{config.contactInfo.name}"
                                        placeholder="Name of server administrator"/></div>
              <p class="help">Name of server administrator</p>
            </div>
          </div>
        </div>

        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Organization</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="input" type="text" name="contact.org"
                                        value="$!{config.contactInfo.organisation}"
                                        placeholder="Organization of server administrator"/></div>
              <p class="help">Organization of server administrator</p>
            </div>
          </div>
        </div>

        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Telephone</label>
          </div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="input" type="text" name="contact.tel"
                                        value="$!{config.contactInfo.telephone}"
                                        placeholder="Telephone number of server administrator"/></div>
              <p class="help">Telephone number of server administrator</p>
            </div>
          </div>
        </div>
        <div class="field  is-horizontal">
          <div class="field-label">
            <label class="label">Email</label></div>
          <div class="field-body">
            <div class="field">
              <div class="control"><input class="input" type="text" name="contact.email"
                                        value="$!{config.contactInfo.email}"
                                        placeholder="Email address of server administrator"/></div>
              <p class="help">Email address of server administrator</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</form>
</body>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="../js/admin.js" rel="script"></script>
</html>


